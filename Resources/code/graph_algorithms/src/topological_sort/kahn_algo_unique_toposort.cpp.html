<pre>
// Sample problem for using this algorithm - UVA 11060 Beverages
#include&lt;bits/stdc++.h&gt;
#define all(a) a.begin(),a.end()
#define ll long long
#define inp(a) scanf("%d",&amp;a)
#define out(a) printf("%d\n",a)
#define inp2(a) scanf("%lld",&amp;a)
#define out2(a) printf("%lld\n",a)
#define arrinput(a,n) for(int i=0;i&lt;n;i++) scanf("%d",&amp;a[i]);
#define pii pair&lt;int,int&gt; 
#define piii pair&lt;int,pair&lt;int,int&gt; &gt;
#define vi vector&lt;int&gt;
#define rep(i,start,n) for(int i=start;i&lt;n;i++)
#define pb push_back
#define F first
#define S second
#define mp make_pair
#define vb vector&lt;bool&gt;
#define testcases() int test;scanf("%d",&amp;test);while(test--)
#define priorityqueue priority_queue&lt;int,vector&lt;int&gt;,greater&lt;int&gt; &gt;
#define minheappop(a) pop_heap(a.begin(),a.end(),compare);a.pop_back();
#define maxheappop(a) pop_heap(a.begin(),a.end());a.pop_back();
#define minheappush(a,b) a.push_back(b);push_heap(a.begin(),a.end(),compare);
#define maxheappush(a,b) a.push_back(b);push_heap(a.begin(),a.end());
const int mod=1000000007;
using namespace std;
map&lt;string, vector&lt;string&gt; &gt; graph;
map&lt;string, int&gt; inDegree;
vector&lt;string&gt; alcohols;
int n,m;
string u,v;
void kahnalgo() {
	set&lt; pair&lt;int,string &gt; &gt; q;
	rep(i,0,alcohols.size()) {
		if(inDegree[alcohols[i]] == 0) {
			q.insert(mp(i,alcohols[i]));
				inDegree[alcohols[i]] = -1;

		}
	}
	while(q.size()) {
		pair&lt;int,string&gt; cc = *q.begin();
		string c = cc.S;
		cout&lt;&lt;" "&lt;&lt;c;
		q.erase(q.begin());
		rep(i,0,graph[c].size()) {
			inDegree[graph[c][i]] -= 1;
		}
		rep(i,0,alcohols.size()) {
			if(inDegree[alcohols[i]] == 0) {
				q.insert(mp(i,alcohols[i]));
				inDegree[alcohols[i]] = -1;
			}
		}	
	}
}
int main()
{
	int cases = 0;
	while(inp(n) != EOF) {
		cases += 1;
		inDegree.clear();
		graph.clear();
		alcohols.clear();
		rep(i,0,n) {
			cin&gt;&gt;u;
			alcohols.pb(u);
			graph[u] = vector&lt;string&gt;();
		}
		inp(m);
		rep(i,0,m) {
			cin&gt;&gt;u&gt;&gt;v;
			inDegree[v] += 1;
			graph[u].pb(v);
		}
		printf("Case #%d: Dilbert should drink beverages in this order:",cases);
		kahnalgo();
		printf(".\n\n");
		getchar();
	} 
    return 0;
}</pre>
